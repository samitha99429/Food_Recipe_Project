{"ast":null,"code":"import React,{useState,useEffect}from'react';import axios from'axios';import'../styles/dashboard.css';import RecipeDetailsModal from'./RecipeDetails';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const Dashboard=()=>{const[categories,setCategories]=useState([]);const[selectedCategory,setSelectedCategory]=useState('Beef');const[recipes,setRecipes]=useState([]);const[selectedRecipe,setSelectedRecipe]=useState(null);const[isModalOpen,setIsModalOpen]=useState(false);const[favorites,setFavorites]=useState([]);useEffect(()=>{const fetchCategories=async()=>{try{const{data}=await axios.get('http://localhost:3001/api/recipes/categories');setCategories(data.slice(0,5));}catch(error){console.error(\"Failed to fetch categories:\",error);}};fetchCategories();},[]);useEffect(()=>{if(selectedCategory){const fetchRecipes=async()=>{try{const{data}=await axios.get(`http://localhost:3001/api/recipes/category/${selectedCategory}`);setRecipes(data);}catch(error){console.error(\"Failed to fetch recipes:\",error);}};fetchRecipes();}},[selectedCategory]);const handleCategoryClick=category=>{setSelectedCategory(category);};const handleRecipeClick=recipe=>{console.log(\"Recipe clicked:\",recipe);setSelectedRecipe(recipe);setIsModalOpen(true);console.log(\"Modal open state:\",isModalOpen);};const closeModal=()=>{setIsModalOpen(false);setSelectedRecipe(null);};useEffect(()=>{const fetchFavorites=async()=>{const token=localStorage.getItem('token');const{data}=await axios.get('http://localhost:3001/api/recipes/favorites',{headers:{Authorization:`Bearer ${token}`}});setFavorites(data);};fetchFavorites();},[]);const handleFavoriteClick=async recipe=>{const token=localStorage.getItem('token');if(!token){console.error(\"User is not authenticated.\");return;}try{const isFavorite=favorites.some(fav=>fav.idMeal===recipe.idMeal);if(isFavorite){await axios.delete(`http://localhost:3001/api/recipes/favorites/${recipe.idMeal}`,{headers:{Authorization:`Bearer ${token}`}});setFavorites(favorites.filter(fav=>fav.idMeal!==recipe.idMeal));console.log('Removed from favorites:',recipe.strMeal);}else{await axios.post('http://localhost:3001/api/recipes/favorites',{idMeal:recipe.idMeal,strMeal:recipe.strMeal,strMealThumb:recipe.strMealThumb},{headers:{Authorization:`Bearer ${token}`}});setFavorites([...favorites,recipe.idMeal]);console.log('Added to favorites:',recipe.strMeal);}}catch(error){console.error('Failed to update favorite recipes:',error);}};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"dashboardcontainer\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Recipe Categories\"}),/*#__PURE__*/_jsx(\"div\",{className:\"categorybuttons\",children:categories.map(category=>/*#__PURE__*/_jsx(\"button\",{className:selectedCategory===category.strCategory?'selected':'',onClick:()=>handleCategoryClick(category.strCategory),children:category.strCategory},category.idCategory))})]}),/*#__PURE__*/_jsx(\"div\",{className:\"recipeGrid\",children:recipes.map(recipe=>/*#__PURE__*/_jsxs(\"div\",{className:\"recipe-card\",children:[/*#__PURE__*/_jsx(\"img\",{src:recipe.strMealThumb,alt:recipe.strMeal,className:\"recipe-image\",onClick:()=>handleRecipeClick(recipe)}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-2\",children:/*#__PURE__*/_jsx(\"span\",{className:`recipe-favorite ${favorites.includes(recipe.idMeal)?'favorite-active':''}`,onClick:()=>handleFavoriteClick(recipe),children:favorites.includes(recipe.idMeal)?'♥':'♡'})}),/*#__PURE__*/_jsx(\"h3\",{className:\"recipe-title\",children:recipe.strMeal})]},recipe.idMeal))}),selectedRecipe&&/*#__PURE__*/_jsx(RecipeDetailsModal,{isOpen:isModalOpen,onRequestClose:closeModal,recipe:selectedRecipe})]});};export default Dashboard;","map":{"version":3,"names":["React","useState","useEffect","axios","RecipeDetailsModal","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Dashboard","categories","setCategories","selectedCategory","setSelectedCategory","recipes","setRecipes","selectedRecipe","setSelectedRecipe","isModalOpen","setIsModalOpen","favorites","setFavorites","fetchCategories","data","get","slice","error","console","fetchRecipes","handleCategoryClick","category","handleRecipeClick","recipe","log","closeModal","fetchFavorites","token","localStorage","getItem","headers","Authorization","handleFavoriteClick","isFavorite","some","fav","idMeal","delete","filter","strMeal","post","strMealThumb","children","className","map","strCategory","onClick","idCategory","src","alt","includes","isOpen","onRequestClose"],"sources":["/Users/samithadilshan/Documents/Company_Projects/codeSec_Final/Food_Recipe_Project/app/src/components/Dashboard.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport '../styles/dashboard.css';\nimport RecipeDetailsModal from './RecipeDetails'; \n\n\nconst Dashboard = () => {\n  const [categories, setCategories] = useState([]);\n  const [selectedCategory, setSelectedCategory] = useState('Beef');\n  const [recipes, setRecipes] = useState([]);\n  const [selectedRecipe, setSelectedRecipe] = useState(null);\n  const [isModalOpen, setIsModalOpen] = useState(false); \n  const [favorites, setFavorites] = useState([]);\n\n  useEffect(() => {\n    const fetchCategories = async () => {\n      try {\n        const { data } = await axios.get('http://localhost:3001/api/recipes/categories');\n        setCategories(data.slice(0, 5)); \n      } catch (error) {\n        console.error(\"Failed to fetch categories:\", error);\n      }\n    };\n    fetchCategories();\n  }, []);\n  \n\n  useEffect(() => {\n    if (selectedCategory) {\n      const fetchRecipes = async () => {\n        try {\n          const { data } = await axios.get(`http://localhost:3001/api/recipes/category/${selectedCategory}`);\n          setRecipes(data); \n          \n        } catch (error) {\n          console.error(\"Failed to fetch recipes:\", error);\n        }\n      };\n\n      fetchRecipes();\n    }\n  }, [selectedCategory]);\n\n  const handleCategoryClick = (category) => {\n    setSelectedCategory(category);\n  };\n\n  const handleRecipeClick = (recipe) => {\n    console.log(\"Recipe clicked:\", recipe);  \n    setSelectedRecipe(recipe);\n    setIsModalOpen(true); \n    console.log(\"Modal open state:\", isModalOpen);  \n  };\n\n\n  const closeModal = () => {\n    setIsModalOpen(false);\n    setSelectedRecipe(null); \n  };\n\n\n  useEffect(() => {\n    const fetchFavorites = async () => {\n      const token = localStorage.getItem('token');\n      const { data } = await axios.get('http://localhost:3001/api/recipes/favorites', {\n        headers: { Authorization: `Bearer ${token}` }\n      });\n      setFavorites(data);\n    };\n\n    fetchFavorites();\n  }, []);\n  \n  const handleFavoriteClick = async (recipe) => {\n    const token = localStorage.getItem('token');\n    \n    if (!token) {\n      console.error(\"User is not authenticated.\");\n      return;\n    }\n  \n    try {\n    const isFavorite = favorites.some(fav => fav.idMeal === recipe.idMeal);\n\n    if (isFavorite) {\n      await axios.delete(`http://localhost:3001/api/recipes/favorites/${recipe.idMeal}`, {\n        headers: { Authorization: `Bearer ${token}` },\n      });\n      setFavorites(favorites.filter(fav => fav.idMeal !== recipe.idMeal));\n      console.log('Removed from favorites:', recipe.strMeal);\n      } else {\n        await axios.post('http://localhost:3001/api/recipes/favorites', {\n          idMeal: recipe.idMeal,\n          strMeal: recipe.strMeal,\n          strMealThumb: recipe.strMealThumb,\n        \n        }, {\n          headers: { Authorization: `Bearer ${token}` },\n        });\n        \n        setFavorites([...favorites, recipe.idMeal]);\n        console.log('Added to favorites:', recipe.strMeal);\n      }\n    } catch (error) {\n      console.error('Failed to update favorite recipes:', error);\n    }\n  };\n  \n\n  return (\n    <>\n      <div className=\"dashboardcontainer\">\n        <h2>Recipe Categories</h2>\n        <div className=\"categorybuttons\">\n          {categories.map((category) => (\n            <button\n              key={category.idCategory}\n              className={selectedCategory === category.strCategory ? 'selected' : '' }\n              onClick={() => handleCategoryClick(category.strCategory)}\n            >\n            \n              {category.strCategory}\n            </button>\n          ))}\n        </div>\n      </div>\n\n\n      <div className=\"recipeGrid\">\n        {recipes.map((recipe) => (\n          <div key={recipe.idMeal} className=\"recipe-card\" >\n            <img\n              src={recipe.strMealThumb}\n              alt={recipe.strMeal}\n              className=\"recipe-image\"\n              onClick={() => handleRecipeClick(recipe)}\n            />\n           <div className='mt-2'>\n              <span\n                className={`recipe-favorite ${favorites.includes(recipe.idMeal) ? 'favorite-active' : ''}`}\n                onClick={() => handleFavoriteClick(recipe)}\n              >\n                {favorites.includes(recipe.idMeal) ? '♥' : '♡'}\n              </span>\n            </div>\n            <h3 className=\"recipe-title\">{recipe.strMeal}</h3>\n          </div>\n        ))}\n      </div>\n\n      \n      {selectedRecipe && (\n        <RecipeDetailsModal\n          isOpen={isModalOpen}\n          onRequestClose={closeModal}\n          recipe={selectedRecipe}\n        />\n      )}\n    </>\n  );\n};\n\nexport default Dashboard;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}